<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>又松大学｜改革战略雷达（iOS 版）</title>
  <style>
    :root{
      --bg:#0b1020;
      --text:#e9ecff;
      --muted:#a9b1d6;
      --blue:#4aa3ff;
      --orange:#ff9a3c;
      --red:#ff4d6d;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, "PingFang TC","Noto Sans TC","Microsoft JhengHei", Arial;
      background: radial-gradient(1200px 900px at 15% 15%, #1b2a6b 0%, var(--bg) 55%),
                  radial-gradient(900px 700px at 85% 25%, #3b1648 0%, rgba(0,0,0,0) 55%);
      color:var(--text);
      padding:16px 14px 22px;
    }
    .wrap{max-width:980px;margin:0 auto;display:grid;grid-template-columns:1fr;gap:12px}
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid rgba(255,255,255,.10);
      border-radius:14px;
      box-shadow: 0 16px 40px rgba(0,0,0,.35);
      overflow:hidden;
    }
    header{padding:14px 14px 10px;border-bottom:1px solid rgba(255,255,255,.10);background: rgba(0,0,0,.12);}
    h1{margin:0;font-size:16px;font-weight:800;letter-spacing:.4px}
    p{margin:8px 0 0;color:var(--muted);font-size:12px;line-height:1.45}
    .main{padding:14px}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin-bottom:12px}
    select, input[type="number"], button{
      background: rgba(255,255,255,.06);
      color:var(--text);
      border:1px solid rgba(255,255,255,.16);
      border-radius:12px;
      padding:10px 10px;
      outline:none;
      font-size:13px;
    }
    button{cursor:pointer}
    .chip{display:inline-flex;align-items:center;gap:8px;padding:8px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.16);background: rgba(0,0,0,.12);font-size:12px;color:var(--muted)}
    .dot{width:10px;height:10px;border-radius:50%}
    .dot.blue{background:var(--blue)}
    .dot.orange{background:var(--orange)}
    .dot.red{background:var(--red)}
    .toggle{display:inline-flex;align-items:center;gap:8px;padding:8px 10px;border-radius:12px;border:1px solid rgba(255,255,255,.14);background: rgba(0,0,0,.12);color:var(--muted);font-size:12px}
    .toggle input{accent-color: var(--blue);}
    .svgbox{
      width:100%;
      background: rgba(0,0,0,.10);
      border:1px solid rgba(255,255,255,.10);
      border-radius:14px;
      padding:10px;
    }
    table{
      width:100%;
      border-collapse:separate;
      border-spacing:0;
      overflow:hidden;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.12);
    }
    th, td{padding:10px 10px;font-size:12px;border-bottom:1px solid rgba(255,255,255,.08);vertical-align:middle}
    th{color:var(--muted);background: rgba(255,255,255,.04);text-align:left}
    tr:last-child td{border-bottom:none}
    .dim{width:38%;font-weight:700}
    .callout{
      margin-top:10px;
      padding:12px 12px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.14);
      font-size:12px;
      line-height:1.45;
    }
    .callout b{color:#fff}
    .noscript{
      margin-top:10px;
      padding:12px;
      border-radius:12px;
      border:1px solid rgba(255,77,109,.35);
      background: rgba(255,77,109,.12);
      color:#ffd7df;
      font-size:12px;
      line-height:1.45;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <header>
        <h1>又松大学｜改革战略雷达（iOS 专用版）</h1>
        <p>此版本改用 <b>SVG</b>（比 Canvas 更稳），在 iPhone/iPad 的 Safari 开启互动效果最佳。</p>
      </header>

      <div class="main">
        <div class="row">
          <label class="chip">模式</label>
          <select id="modeSel">
            <option value="strategic" selected>合成战略（6维度）</option>
            <option value="ug_3p1">本科：3+1 专升本</option>
            <option value="ug_1p3">本科：1+3 委托培养</option>
            <option value="ms_1to1p5">硕士：1~1.5年制</option>
            <option value="phd_2to2p5">博士：2~2.5年制</option>
          </select>

          <span class="chip"><span class="dot blue"></span>现况</span>
          <span class="chip"><span class="dot orange"></span>改革目标</span>
          <span class="chip"><span class="dot red"></span>市场/竞品</span>

          <label class="toggle"><input id="showNow" type="checkbox" checked />现况</label>
          <label class="toggle"><input id="showTarget" type="checkbox" checked />目標</label>
          <label class="toggle"><input id="showMarket" type="checkbox" checked />市場</label>

          <button id="resetBtn">重置</button>
        </div>

        <div class="svgbox">
          <svg id="radarSvg" viewBox="0 0 520 520" width="100%" height="420" role="img" aria-label="Radar chart">
            <g id="grid"></g>
            <g id="axes"></g>
            <g id="polys"></g>
          </svg>
        </div>

        <div class="callout">
          <b>一句话叙事：</b>我们最大的問題不是貴，而是「貴，卻沒有被设计成值得」——所以改革要把价值做厚、把体验做順、把路径做清。
        </div>

        <noscript>
          <div class="noscript">
            你的浏览器目前未執行 JavaScript，所以互动功能無法啟動。请用 Safari 开启此檔案（分享 → Safari）再試一次。
          </div>
        </noscript>
      </div>
    </div>

    <div class="card">
      <header>
        <h1>数值编辑器（0–5）</h1>
        <p>直接改分数，雷達即時更新（支援小數）。</p>
      </header>
      <div class="main">
        <table id="editTable">
          <thead>
            <tr>
              <th class="dim">维度</th>
              <th>现况</th>
              <th>目標</th>
              <th>市場</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>

        <div class="callout">
          <b>简报操作：</b>先只显示「现况 + 市場」→ 再打開「目標」，讓“外擴”成為改革的視覺證據。
        </div>
      </div>
    </div>
  </div>

<script>
const PRESETS = {
  strategic: {
    labels: ["入学流程体验","學制弹性","专业/路径","服务陪伴","奖学金设计","费用感知(学费)"],
    now:    [2.0, 1.5, 2.0, 2.5, 2.0, 1.0],
    target: [4.0, 4.5, 4.0, 4.5, 4.0, 1.0],
    market: [3.0, 3.0, 3.5, 3.0, 3.0, 3.0]
  },
  ug_3p1: {
    labels: ["可選专业","入学金優勢","学费優勢","奖学金","留学生服务"],
    now:    [1.0, 1.0, 0.5, 0.5, 0.0],
    target: [3.5, 2.0, 0.5, 2.5, 4.0],
    market: [3.2, 3.5, 4.5, 4.0, 3.0]
  },
  ug_1p3: {
    labels: ["QS排名","開辦時間","合作院校數量","学费優勢","奖学金優勢"],
    now:    [0.0, 4.0, 2.0, 2.0, 3.0],
    target: [2.0, 4.0, 4.0, 2.0, 4.2],
    market: [3.2, 1.5, 4.8, 3.5, 3.8]
  },
  ms_1to1p5: {
    labels: ["學制","宿舍提供情況","入学金優勢","学费優勢","奖学金優勢"],
    now:    [5.0, 0.0, 1.0, 1.0, 2.0],
    target: [5.0, 3.5, 2.0, 1.0, 4.0],
    market: [4.0, 3.8, 3.5, 4.5, 3.5]
  },
  phd_2to2p5: {
    labels: ["學制","入学金優勢","学费優勢","奖学金"],
    now:    [4.0, 2.0, 2.0, 1.0],
    target: [4.5, 2.5, 2.0, 3.5],
    market: [3.0, 4.0, 5.0, 3.5]
  }
};

let state = JSON.parse(JSON.stringify(PRESETS));
let currentMode = "strategic";
const MAX = 5;

const modeSel = document.getElementById('modeSel');
const showNow = document.getElementById('showNow');
const showTarget = document.getElementById('showTarget');
const showMarket = document.getElementById('showMarket');
const resetBtn = document.getElementById('resetBtn');
const tbody = document.querySelector('#editTable tbody');

const gridG = document.getElementById('grid');
const axesG = document.getElementById('axes');
const polysG = document.getElementById('polys');

function cssVar(name){ return getComputedStyle(document.documentElement).getPropertyValue(name).trim(); }
function pt(cx, cy, r, a){ return { x: cx + r*Math.cos(a), y: cy + r*Math.sin(a) }; }
function toPath(points){
  return points.map((p,i)=> (i===0?`M ${p.x.toFixed(2)} ${p.y.toFixed(2)}`:`L ${p.x.toFixed(2)} ${p.y.toFixed(2)}`)).join(' ') + ' Z';
}
function clear(el){ while(el.firstChild) el.removeChild(el.firstChild); }

function drawBase(labels){
  clear(gridG); clear(axesG);
  const n = labels.length;
  const cx = 260, cy = 270, R = 180;
  const a0 = -Math.PI/2;

  const rings = 5;
  for(let k=1;k<=rings;k++){
    const rr = R*(k/rings);
    const pts = [];
    for(let i=0;i<n;i++){
      const a = a0 + i*(2*Math.PI/n);
      pts.push(pt(cx,cy,rr,a));
    }
    const path = document.createElementNS("http://www.w3.org/2000/svg","path");
    path.setAttribute("d", toPath(pts));
    path.setAttribute("fill","none");
    path.setAttribute("stroke",`rgba(255,255,255,${0.06+k*0.01})`);
    path.setAttribute("stroke-width","1");
    gridG.appendChild(path);
  }

  for(let i=0;i<n;i++){
    const a = a0 + i*(2*Math.PI/n);
    const p2 = pt(cx,cy,R,a);

    const line = document.createElementNS("http://www.w3.org/2000/svg","line");
    line.setAttribute("x1", cx); line.setAttribute("y1", cy);
    line.setAttribute("x2", p2.x); line.setAttribute("y2", p2.y);
    line.setAttribute("stroke","rgba(255,255,255,0.10)");
    line.setAttribute("stroke-width","1");
    axesG.appendChild(line);

    const labelP = pt(cx,cy,R*1.22,a);
    const text = document.createElementNS("http://www.w3.org/2000/svg","text");
    text.textContent = labels[i];
    text.setAttribute("x", labelP.x);
    text.setAttribute("y", labelP.y);
    text.setAttribute("fill","rgba(233,236,255,0.92)");
    text.setAttribute("font-size","13");
    text.setAttribute("font-weight","600");
    text.setAttribute("dominant-baseline","middle");
    const c = Math.cos(a);
    text.setAttribute("text-anchor", c>0.2 ? "start" : (c<-0.2 ? "end" : "middle"));
    axesG.appendChild(text);
  }
}

function drawPolys(){
  clear(polysG);
  const m = state[currentMode];
  const labels = m.labels;
  const n = labels.length;
  const cx = 260, cy = 270, R = 180;
  const a0 = -Math.PI/2;

  function build(values){
    const pts = [];
    for(let i=0;i<n;i++){
      const v = Math.max(0, Math.min(MAX, values[i]));
      const rr = R*(v/MAX);
      const a = a0 + i*(2*Math.PI/n);
      pts.push(pt(cx,cy,rr,a));
    }
    return pts;
  }

  const datasets = [
    {values:m.now, color:cssVar("--blue"), visible:showNow.checked},
    {values:m.target, color:cssVar("--orange"), visible:showTarget.checked},
    {values:m.market, color:cssVar("--red"), visible:showMarket.checked},
  ];

  datasets.forEach(ds=>{
    if(!ds.visible) return;
    const pts = build(ds.values);

    const fill = document.createElementNS("http://www.w3.org/2000/svg","path");
    fill.setAttribute("d", toPath(pts));
    fill.setAttribute("fill", ds.color);
    fill.setAttribute("fill-opacity","0.12");
    polysG.appendChild(fill);

    const stroke = document.createElementNS("http://www.w3.org/2000/svg","path");
    stroke.setAttribute("d", toPath(pts));
    stroke.setAttribute("fill","none");
    stroke.setAttribute("stroke", ds.color);
    stroke.setAttribute("stroke-width","3");
    stroke.setAttribute("stroke-linejoin","round");
    polysG.appendChild(stroke);

    pts.forEach(p=>{
      const c = document.createElementNS("http://www.w3.org/2000/svg","circle");
      c.setAttribute("cx", p.x);
      c.setAttribute("cy", p.y);
      c.setAttribute("r", "4");
      c.setAttribute("fill", ds.color);
      c.setAttribute("stroke", "rgba(0,0,0,0.25)");
      c.setAttribute("stroke-width","1");
      polysG.appendChild(c);
    });
  });
}

function renderTable(){
  tbody.innerHTML = "";
  const m = state[currentMode];
  m.labels.forEach((label, i)=>{
    const tr = document.createElement('tr');
    const tdDim = document.createElement('td');
    tdDim.className = "dim";
    tdDim.textContent = label;
    tr.appendChild(tdDim);
    tr.appendChild(makeCell('now', i));
    tr.appendChild(makeCell('target', i));
    tr.appendChild(makeCell('market', i));
    tbody.appendChild(tr);
  });
}

function makeCell(key, idx){
  const td = document.createElement('td');
  const input = document.createElement('input');
  input.type = "number";
  input.min = 0; input.max = 5; input.step = 0.1;
  input.value = state[currentMode][key][idx].toFixed(1);
  input.style.width = "86px";
  input.addEventListener('input', ()=>{
    const v = parseFloat(input.value);
    state[currentMode][key][idx] = isNaN(v) ? 0 : Math.max(0, Math.min(5, v));
    drawPolys();
  });
  td.appendChild(input);
  return td;
}

function renderAll(){
  const m = state[currentMode];
  drawBase(m.labels);
  drawPolys();
  renderTable();
}

modeSel.addEventListener('change', ()=>{ currentMode = modeSel.value; renderAll(); });
[showNow, showTarget, showMarket].forEach(el => el.addEventListener('change', drawPolys));
resetBtn.addEventListener('click', ()=>{ state[currentMode] = JSON.parse(JSON.stringify(PRESETS[currentMode])); renderAll(); });

renderAll();
</script>
</body>
</html>
